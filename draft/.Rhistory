n = n(),
mean = mean(Time),
sd = sd(Time),
se = sd / sqrt(n)
)
summ_bm
m = bm %>%
filter(Sex == "male") %>%
pull(Time)
f = bm %>%
filter(Sex == "female") %>%
pull(Time)
t.test(m)
t.test(f)
summ_bm %>%
mutate(ci_low = mean - qt(.975, 50 - 1) * se,
ci_high = mean + qt(.975, 50 - 1) * se) %>%
select(Sex, ci_low, ci_high)
tidy(1:)
tidy(1:4)
?tidy()
?t_mult
f_summodel = linear_reg() %>%
set_engine("lm") %>%
fit(Time ~ 1, data = data)
f_sum = tidy(model)
f_sum
model = linear_reg() %>%
set_engine("lm") %>%
fit(Time ~ 1, data = data)
f_sum = tidy(model)
f_sum
qnorm(0.975)
qt(0.975, 10000000)
qt(0.975, 1000000)
qt(0.975, 10000)
qt(0.975, 100)
qt(0.975, 1000)
qnorm(1-0.00101)
qt(1-0.00101, 49)
pt(3.3913, 96.396)
1 -pt(3.3913, 96.396)
qt(0.975, 60)
pt(43.498, 49)
pt(3.3913, 96.396)
x = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
sd(x)
se = sd(x) / sqrt(length(x))
mean(x) / se
qt(0.0975, length(x) - 1)
# CI = mu +- ME
# ME = t_stat * SE
summ_bm %>%
mutate(ci_low = mean - qt(.975, 50 - 1) * se,
ci_high = mean + qt(.975, 50 - 1) * se) %>%
select(Sex, ci_low, ci_high)
?v_line
?vline
# gt and geom_t_fill
# check df
gt(50 - 1) +
geom_vline(xintercept = 3.3913, color = "red", linetype = "dashed", alpha = 0.5) +
geom_t_fill(df = 50 -1, a = 3.3913, b = 10) +
geom_t_fill(df = 50 -1, a = -3.3913, b = -10)
# geom_t_fill(50 -1, a = )
# gt and geom_t_fill
# check df
gt(50 - 1) +
geom_vline(xintercept = 3.3913, color = "red", linetype = "dashed", alpha = 0.5) +
geom_t_fill(df = 50 -1, a = 3.3913) +
geom_t_fill(df = 50 -1, b = --3.3913)
# geom_t_fill(50 -1, a = )
# gt and geom_t_fill
# check df
gt(50 - 1) +
geom_vline(xintercept = 3.3913, color = "red", linetype = "dashed", alpha = 0.5) +
geom_t_fill(df = 50 -1, a = 3.3913) +
geom_t_fill(df = 50 -1, b = -3.3913)
# geom_t_fill(50 -1, a = )
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE,
cache=TRUE, autodep=TRUE, cache.comments=FALSE)
library(tidyverse)
data = read_csv("../all_races.csv")
data = read_csv("./all_races.csv")
improvement = data %>%
# lm y ~ x will produce summary table of intercept and slope
# We grab the slope of game_num to wpm and store in the imp column
group_by(name) %>%
mutate(b = lm(wpm ~ game_num)$coefficients[1], m = lm(wpm ~ game_num)$coefficients[2]) %>%
group_by(name) %>%
summarize(n = n(), imp = n * m / b) %>%
distinct()
head(improvement)
data = read_csv("./all_races.csv")
improvement = data %>%
# lm y ~ x will produce summary table of intercept and slope
# We grab the slope of game_num to wpm and store in the imp column
group_by(name) %>%
mutate(b = lm(wpm ~ game_num)$coefficients[1], m = lm(wpm ~ game_num)$coefficients[2]) %>%
group_by(name) %>%
summarize(n = n(), imp = n * m / b) %>%
distinct()
head(improvement)
View(data)
sample_chart = data %>%
filter(name == "ulmaa")
ggplot(sample_chart, aes(x = races, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE)
ggplot(sample_chart, aes(x = game_num, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE)
ggplot(sample_chart, aes(x = game_num, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE) +
xlab("Race Number") +
ylab("Typing Speed (Words Per Minute)") +
ggtitle("Typing Improvement over Race Number", subtitle = "Racer Ulmaa")
sample_chart = data %>%
filter(name == "ulmaa")
ggplot(sample_chart, aes(x = game_num, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE) +
xlab("Race Number") +
ylab("Typing Speed (Words Per Minute)") +
ggtitle("Typing Improvement over Number of Races", subtitle = "Racer Ulmaa")
sample_chart = data %>%
filter(name == "ulmaa")
ggplot(sample_chart, aes(x = game_num, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE) +
xlab("Race #") +
ylab("Typing Speed (Words Per Minute)") +
ggtitle("Typing Improvement over Number of Races", subtitle = "Racer Ulmaa")
ggplot(sample_chart, aes(x = game_num, y = wpm)) +
geom_jitter() +
geom_smooth(method = "lm", se = FALSE) +
xlab("Number of Races") +
ylab("Typing Speed (Words Per Minute)") +
ggtitle("Typing Improvement over Number of Races", subtitle = "Racer Ulmaa")
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - game_num * m + b
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0)
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0)
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red", alpha = 0.5)
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red", width = 2)
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red", lineWidth = 2)
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red")
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red")
sample_chart %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
mutate(
res = wpm - (game_num * m + b)
) %>%
select(game_num, res) %>%
ggplot(aes(x = game_num, y = res)) +
geom_jitter() +
geom_hline(yintercept = 0, color = "red") +
xlab("Number of Races") +
ylab("Residuals (Words Per Minute)") +
ggtitle("Regression Model Residuals for Typing Speed Over Races", subtitle = "Racer Ulmaa")
View(improvement)
imp_sum = improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp)) %>%
mutate(t_stat = (xbar - 0) / (s / sqrt(n)))
imp_sum
t_stat = imp_sum %>% pull(tstat)
imp_sum = improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp)) %>%
mutate(t_stat = (xbar - 0) / (s / sqrt(n)))
imp_sum
t_stat = imp_sum %>% pull(t_stat)
t_stat
View(imp_sum)
View(improvement)
imp_sum = improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp, na.rm = TRUE)) %>%
mutate(t_stat = (xbar - 0) / (s / sqrt(n)))
imp_sum
t_stat = imp_sum %>% pull(t_stat)
t_stat
View(improvement)
sd(improvement$imp)
improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp))
improvement
data = read_csv("./all_races.csv")
improvement = data %>%
# lm y ~ x will produce summary table of intercept and slope
# We grab the slope of game_num to wpm and store in the imp column
group_by(name) %>%
mutate(
b = lm(wpm ~ game_num)$coefficients[1],
m = lm(wpm ~ game_num)$coefficients[2]
) %>%
group_by(name) %>%
summarize(n = n(), imp = n * m / b) %>%
distinct() %>%
ungroup()
head(improvement)
imp_sum = improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp)) %>%
mutate(t_stat = (xbar - 0) / (s / sqrt(n)))
imp_sum
t_stat = imp_sum %>% pull(t_stat)
t_stat
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1, a = 0, b = 12) +
geom_t_fill(df = imp_sum$n, a = -10, b = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
theme_minimal()
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE,
cache=TRUE, autodep=TRUE, cache.comments=FALSE)
library(tidyverse)
source("../../scripts/viridis.R")
source("../../scripts/ggprob.R")
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1, a = 0, b = 12) +
geom_t_fill(df = imp_sum$n, a = -10, b = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
theme_minimal()
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
theme_minimal()
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n, a = t_stat) +
geom_t_fill(df = imp_sum$n, b = -t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("")
theme_minimal()
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_t_fill(df = imp_sum$n - 1, b = -t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("")
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1) * 2)
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_t_fill(df = imp_sum$n - 1, b = -t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("")
theme_minimal()
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("")
theme_minimal()
p_value
p_value
p_value = imp_sum %>% pull(p_value)
p_value
imp_sum = improvement %>%
summarize(n = n(),
xbar = mean(imp),
s = sd(imp)) %>%
mutate(t_stat = (xbar - 0) / (s / sqrt(n)))
imp_sum
t_stat = imp_sum %>% pull(t_stat)
t_stat
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("")
theme_minimal()
specify_decimal(p_value, 100)
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("") +
theme_minimal()
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("Normalized T Distribution with Test Statistic") +
theme_minimal()
imp_sum = imp_sum %>%
mutate(p_value = pt(t_stat, n - 1))
imp_sum
p_value = imp_sum %>% pull(p_value)
p_value
gt(df = imp_sum$n - 1) +
geom_t_fill(df = imp_sum$n - 1, a = t_stat) +
geom_vline(xintercept = t_stat, color = "red", linetype = "dashed") +
xlab("t") +
ylab("Density") +
ggtitle("Normalized T Distribution with Test Statistic",
subtitle="For all racers") +
theme_minimal()
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE,
cache=TRUE, autodep=TRUE, cache.comments=FALSE)
library(tidyverse)
library(httr)
library(rvest)
library(jsonlite)
library(lubridate)
setwd("~/Projects/STAT_240/project/draft")
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE,
cache=TRUE, autodep=TRUE, cache.comments=FALSE)
library(tidyverse)
library(httr)
library(rvest)
library(jsonlite)
library(lubridate)
# ignore this function for now
# update_racer = function(id)
# {
#   path = "https://typeracerdata.com/import";
#   parameters = list(username = id)
#
#   request = GET(url = path, query = parameters)
# }
store_races = function(id, races)
{
# Endpoint will feed in id and total races
path = "https://data.typeracer.com/games";
parameters = list(
playerId = str_c("tr:", id),
n = races
)
tryCatch(
{
request = GET(url = path, query = parameters)
# Convert request json to tibble, some renaming for clarity
# General data cleanup, removing uneeded columns and converting datetimes
races = as_tibble(fromJSON(content(request, 'text'))) %>%
rename(
accuracy = ac,
time = t,
game_num = gn,
racers_num = np,
points = pts
) %>%
select(everything(), -r, -sl, -tid) %>%
mutate(time = as_datetime(time))
# Write to csv in race_log folder with id
write_csv(races, str_c("race_log/", id, ".csv"))
},
error = function(e) {
# If encounters error with parsing, then sleep for 60 seconds and try again
print(str_c("error with ", id))
print(e)
Sys.sleep(60)
store_races(id, races)
}
)
return ( NULL )
}
store_races("cheffray", 3500)
store_races
store_races("cheffray", 2500)
knitr::opts_chunk$set(echo=TRUE, message=FALSE, warning=FALSE,
cache=TRUE, autodep=TRUE, cache.comments=FALSE)
library(tidyverse)
data = read_csv("./cheffray.csv")
summary3 = data %>%
group_by(racers_num) %>%
summarize(mean_wpm = mean(wpm), count = n())
ggplot(summary3, aes(x = as.factor(racers_num), y = mean_wpm)) +
geom_col(fill = "darkblue") +
geom_text(aes(label = round(mean_wpm)), vjust = 1.5, colour = "white") +
geom_text(aes(label = str_c("(",count,")")), vjust = 3.0, colour = "white") +
xlab("Racers on Track") +
ylab("Average WPM") +
ggtitle("Typing Speeds based on Number of Racers Raced Against", subtitle="Rounded WPM with (total race count)")
